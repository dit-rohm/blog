<!DOCTYPE html> <html lang=ja> <head> <meta charset=utf-8> <meta http-equiv=X-UA-Compatible content='IE=edge'> <meta name=viewport content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"> <title>ディープラーニングで講義のレポートを自動執筆 - DIT Mentor Blog</title> <meta name=keywords content=""> <meta name=description content="機械学習でもうひとりの僕を作ります"> <meta property="og:site_name" content="DIT Mentor Blog"> <meta property="og:title" content="ディープラーニングで講義のレポートを自動執筆"> <meta property="og:description" content="機械学習でもうひとりの僕を作ります"> <meta property="og:type" content=article> <meta property="og:url" content="https://blog.dit-rohm.com/2015/11/17/recurrent-neural-network.html"> <meta property="og:image" content="https://blog.dit-rohm.com/images/2015-11-17/eyecatch.png"> <meta property="fb:app_id" content=866054163477643> <meta name="twitter:card" content=summary_large_image> <meta name="twitter:site" content="@dit_rohm"> <link href="/images/favicon.png" rel=icon type="image/png"/> <link rel=alternate type="application/atom+xml" title="Atom Feed" href="/feed.xml"/> <link href="/stylesheets/blog.css" rel=stylesheet /> <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-61361620-3', 'auto');
  ga('send', 'pageview');
</script> </head> <body> <header class=blog_header> <nav class="navbar navbar-default navbar-fixed-top"> <div class=container-fluid> <div class=navbar-header> <button type=button class=navbar-toggle data-toggle=collapse data-target="#bs-example-navbar-collapse-1"> <span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span> </button> <a class=navbar-brand href="https://dit-rohm.com/">DIT</a> </div> <div class="collapse navbar-collapse" id=bs-example-navbar-collapse-1> <ul class="nav navbar-nav"> <li class=active><a href="/">Blog Home</a></li> <li class=dropdown> <a href="#" class=dropdown-toggle data-toggle=dropdown>Tags <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href="/tags/Debian.html">Debian</a> </li> <li> <a href="/tags/Linux.html">Linux</a> </li> <li> <a href="/tags/VPS.html">VPS</a> </li> <li> <a href="/tags/アプリ.html">アプリ</a> </li> <li> <a href="/tags/カメラ.html">カメラ</a> </li> <li> <a href="/tags/音楽.html">音楽</a> </li> </ul> </li> <li class=dropdown> <a href="#" class=dropdown-toggle data-toggle=dropdown>Archives <b class=caret></b></a> <ul class=dropdown-menu role=menu> <li role=presentation class=dropdown-header>2015年</li> <li><a href="/2015/11.html">11月</a></li> <li><a href="/2015/08.html">08月</a></li> <li><a href="/2015/07.html">07月</a></li> <li><a href="/2015/06.html">06月</a></li> <li><a href="/2015/05.html">05月</a></li> </ul> </li> </ul> </div> </div> </nav> <div class="jumbotron top-catch"> <h1 class=midashi-en><a href="/">DIT Mentor Blog</a></h1> <hr class=header-hr> <h5 class=midashi-ja>DITメンターブログ</h5> </div> </header> <div id=main role=main> <div class=container> <div class=row> <div class=col-sm-1> </div> <div class=col-sm-2> <p class=tags>Tags</p> </div> <div class="col-sm-7 post"> <h1 class=article-title>ディープラーニングで講義のレポートを自動執筆</h1> <p class=article-date>2015/11/17</p> <hr> <p>どうも初めまして、メンターのきよまるです。 僕は大学に入るまで、学校の課題というものをやったことがありませんでした。 高校時代には、あまりの課題提出率の低さから、家に電話がかかってきたこともありました。 しかし僕にとってそんなことは関係ありませんでした。 その課題に時間をかけてやるだけの価値が本当にあるのか。 それを決めるのは僕自身であるべきだと強く確信していたからです。 先生はいつも苛立ちと失望の混じり合った表情で問いかけます。 「どうして君は課題を出さないのか。」 その度に僕はこう返しました。 <strong>「言われたことしかできない奴は、この先の人生で何もできはしない。」</strong> さあ、僕と一緒にサボりの向こう側の景色を見ませんか。</p> <h2>機械学習とは</h2> <p>機械学習の研究は人工知能の研究の一部として始まりました。 そこで最も重要なのは人間の知識や考え方をどのように表現し、どのように利用するかということです。 プログラミング言語にはif文やfor文がありますが、これは人間の考えを明示的に表現したものだと言えます。 しかしながら人の思考はややこしく、特に何かを認識したり運動を学習したりすることは、そのような形で明示的に表現することが非常に困難です。 そのような問題へのアプローチとして現在注目されているのが機械学習です。 脳はニューロンという神経細胞がシナプスという結合部位を通して他のニューロンとのネットワークを構築しているのですが、この働きに着想を得て、機械学習ではニューラルネットワークという情報処理メカニズムが用いられています。</p> <h2>レポートをさぼるためにやらなきゃいけないこと</h2> <p>さて、レポートをさぼるために必要なことは大きく分けて以下の２つです。</p> <ul> <li>今までのレポートを学習させる。</li> <li>学習によって得られたモデルから文章を生成する。</li> </ul> <p>順番に見て行きましょう。</p> <h3>今までのレポートを学習させる。</h3> <p>日本語は英語のように単語をスペースで区切らないため、初めに学習の前処理として文章を形態素解析してやる必要があります。 今回は有名な日本語形態素解析システムであるMeCabを使ってやってみました。 元の文章がこちら。 <code> 「今回の演習実験の目的は、パターン認識についての基本的なアルゴリズムを学ぶことである。」 </code> 形態素解析したものがこちら。 <code> 「今回 の 演習 実験 の 目的 は 、 パターン 認識 について の　基本 的 な アルゴリズ　ム を 学ぶ こと で ある 。」 </code> ところどころあれな気もしますけどまぁいいんじゃないでしょうか。 こんな感じで僕のレポートをばらばらにしてやります。 とりあえず準備はオッケーでしょう。 さて、文章の学習にはLSTM(long short-term memory)法を用いたRNN(Recurrent Neural Network)を用いました。 RNNは、自身の出力をフィードバックさせるニューラルネットワークモデルで、時系列データを扱う際などによく用いられます。 このRNNには、誤差信号が隠れ層をたどっていく中で勾配が小さくなり、意図した大きさで伝わらなくなる勾配消失問題というものがあるのですが、LSTM法を導入することで長い時間差を持った共起関係を考慮した最適化が可能になります。 こんな感じでコーディングしました。</p> <pre class="highlight python"><code><span class="k">def</span> <span class="nf">forward_one_step</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">gpu</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">x_data</span> <span class="o">=</span> <span class="n">cuda</span><span class="o">.</span><span class="n">to_gpu</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span>
        <span class="n">y_data</span> <span class="o">=</span> <span class="n">cuda</span><span class="o">.</span><span class="n">to_gpu</span><span class="p">(</span><span class="n">y_data</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">chainer</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">volatile</span><span class="o">=</span><span class="ow">not</span> <span class="n">train</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">chainer</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">y_data</span><span class="p">,</span> <span class="n">volatile</span><span class="o">=</span><span class="ow">not</span> <span class="n">train</span><span class="p">)</span>
    <span class="n">h0</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">h1_in</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">l1_x</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">h0</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="n">train</span><span class="p">))</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">l1_h</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="s">'h1'</span><span class="p">])</span>
    <span class="n">c1</span><span class="p">,</span> <span class="n">h1</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">lstm</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="s">'c1'</span><span class="p">],</span> <span class="n">h1_in</span><span class="p">)</span>
    <span class="n">h2_in</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">l2_x</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="n">train</span><span class="p">))</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">l2_h</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="s">'h2'</span><span class="p">])</span>
    <span class="n">c2</span><span class="p">,</span> <span class="n">h2</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">lstm</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="s">'c2'</span><span class="p">],</span> <span class="n">h2_in</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">l3</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">h2</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="n">train</span><span class="p">))</span>
    <span class="n">state</span> <span class="o">=</span> <span class="p">{</span><span class="s">'c1'</span><span class="p">:</span> <span class="n">c1</span><span class="p">,</span> <span class="s">'h1'</span><span class="p">:</span> <span class="n">h1</span><span class="p">,</span> <span class="s">'c2'</span><span class="p">:</span> <span class="n">c2</span><span class="p">,</span> <span class="s">'h2'</span><span class="p">:</span> <span class="n">h2</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">state</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">softmax_cross_entropy</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
</code></pre> <h2>学習によって得られたモデルから文章を生成する。</h2> <p>実はほとんど学習とやることは同じです。 ただ、一番確率の高いものを選ぶようなアルゴリズムにすると、同じワードの堂々巡りになることが予想されるため、確率分布に従ってランダムに選択するように実装すれば良いでしょう。 これできっとナイスなレポートを生成できるはずです。</p> <h1>レポートを書かせる</h1> <p>ついにこの時がやってきました。 僕の純朴なクローンが見事、レポートを書ききってくれることでしょう。 これが人類の新たな一歩です！</p> <p><img alt="実行結果" src="/images/2015-11-17/result.png"/></p> <p>おお…。 ひどい…。 なんてこった…。</p> <h1>おわりに</h1> <p>「私」という言葉の後に続く可能性のある語には、例えば「は」があったり、「が」があったりします。 このように、ある語の後に続く可能性のある語のバリエーション数を平均したものをパープレキシティと言い、しばしば自然言語処理ではモデルの確からしさを表す指標にされるのですが、今回のデータセットとプログラムから作成されたモデルはパープレキシティが300以上ありました。 先ほどの結果から、１度や2度しか出てこない単語が学習の妨げになっていることが推測されます。 この原因には、そもそもデータセットが様々なテーマの実験レポートのみであったことが考えられますが、今後そのような低頻度で出現する単語に対してどのような学習を行うかは検討していく必要があるでしょう。 いかがだったでしょうか。 僕の自動レポート執筆大作戦は、残念ながら成功とは言えない結果に終わりましたがまだ終わりではありません。 理工学部の学生として、楽をするための努力は生涯を通じて続けるべきです。 さあ、あなたも僕と一緒にシンギュラリティの向こう側へ挑戦してみませんか。</p> </div> <div class=col-sm-2> </div> </div> </div> </div> <div class="social-buttons clearfix"> <ul> <li> <a href="https://twitter.com/share" class=twitter-share-button data-url="https://blog.dit-rohm.com/2015/11/17/recurrent-neural-network.html" data-via=dit_rohm data-related=dit_rohm>Tweet</a> </li> <li> <div class=fb-share-button data-href="https://blog.dit-rohm.com/2015/11/17/recurrent-neural-network.html" data-layout=button_count></div> </li> <li> <a data-pocket-label=pocket data-pocket-count=horizontal class=pocket-btn data-lang=en></a> </li> <li> <a href="https://b.hatena.ne.jp/entry/https://blog.dit-rohm.com/2015/11/17/recurrent-neural-network.html" class=hatena-bookmark-button data-hatena-bookmark-title="ディープラーニングで講義のレポートを自動執筆 - dit" data-hatena-bookmark-layout=standard-balloon data-hatena-bookmark-lang=ja title="このエントリーをはてなブックマークに追加"> <img src="https://b.st-hatena.com/images/entry-button/button-only.png" alt="このエントリーをはてなブックマークに追加" width=20 height=20 style="border: none;"/></a> </li> </ul> </div> <footer class=blog_footer> <div class="inner container"> <div class=row> <div class="col-md-4 col-sm-6 footer-content"> <h3>Recent Post</h3> <ul> <li><p class=post-date><time datetime="2015-11-17T17:43">2015/11/17</time></p> <p class=post-title><a href="/2015/11/17/recurrent-neural-network.html">ディープラーニングで講義のレポートを自動執筆</a></p></li> </ul> <ul> <li><p class=post-date><time datetime="2015-11-10T21:00">2015/11/10</time></p> <p class=post-title><a href="/2015/11/10/hackathon.html">初心者がハッカソンに参加してみた結果</a></p></li> </ul> <ul> <li><p class=post-date><time datetime="2015-08-13T00:00">2015/08/13</time></p> <p class=post-title><a href="/2015/08/13/IP.html">知っておくべき知的財産権　著作権</a></p></li> </ul> <ul> <li><p class=post-date><time datetime="2015-08-06T21:13">2015/08/06</time></p> <p class=post-title><a href="/2015/08/06/bilingual-news.html">バイリンガルニュースのおすすめ回6選</a></p></li> </ul> <ul> <li><p class=post-date><time datetime="2015-07-28T10:00">2015/07/28</time></p> <p class=post-title><a href="/2015/07/28/on-the-train.html">通学中の暇つぶしにおすすめなこと15選</a></p></li> </ul> </div> <div class="col-md-4 col-sm-6 footer-content"> <h3>About Author</h3> <p class=about-auther>DIT（Doshisha Institute of Technology）は、技術力向上を目的とし同志社／同志社女子大学の学生向けに勉強会やハッカソンを開催する<a href="http://rohm.doshisha.ac.jp/" target=_blank>ローム記念館プロジェクト</a>です。</p> <p class=about-auther>このブログではDITのお知らせ、活動報告のほかに開発、プログラミング等についても書いていきます。</p> <div class=sns-link> <h4>- SNS</h4> <a href="https://twitter.com/dit_rohm/" target=_blank><img src="/images/twitter_logo.png" alt=Twitter></a> <a href="https://facebook.com/dit_rohm/" target=_blank><img src="/images/fb_logo.png" alt=Facebook></a> </div> </div> <div class="col-md-4 col-sm-6 footer-content"> <h3>DIT Website</h3> <p class=about-auther>DITのウェブサイトです。DITについてや参加申し込み、FAQなどはこちらのサイトをご覧ください。</p> <ul> <li><p class=dit-link><a href="https://dit-rohm.com/">HOME</a></p></li> <li><p class=dit-link><a href="https://dit-rohm.com/about.html">ABOUT</a></p></li> <li><p class=dit-link><a href="https://dit-rohm.com/faq.html">FAQ</a></p></li> </ul> </div> </div> <p class=copyright><small>&copy; DIT 2015</small></p> </div> </footer> <script src="/javascripts/all.js"></script> </body> </html>